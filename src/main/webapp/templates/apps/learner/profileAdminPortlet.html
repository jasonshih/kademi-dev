<div class="panel panel-default">
	<div class="panel-heading">
		<i class="clip-stats"></i>
		Statistics
	</div>
	<div class="panel-body">
		<p class="clearfix">
			<button type="button" class="pull-right btn btn-primary btn-complete-module">Force complete module</button>
		</p>
		<h4>Overall Progress</h4>
		<table class="table table-bordered table-striped table-hover">
			<thead>
				<tr>
					<th>Website</th>
					<th>Program</th>
					<th>Progress</th>
				</tr>
			</thead>
			<tbody>
				#foreach($lp in $learningProcesses)
				<tr>
					<td>$lp.website.name</td>
					<td>$lp.programCode</td>
					<td>$lp.stateName</td>
				</tr>
				#end
			</tbody>
		</table>
		<hr />
		<h4>Module Progress</h4>
		<table class="table table-bordered table-striped table-hover">
			<thead>
				<tr>
					<th>Website</th>
					<th>Module</th>
					<th>Progress</th>
					<th>Started</th>
					<th>Last access</th>
					<th>Quiz attempts</th>
					<th>Certificates</th>
				</tr>
			</thead>
			<tbody>
				#if( $moduleStatuses.isEmpty() )
				<tr>
					<td colspan="7">No modules have been started</td>
				</tr>
				#else
				#set($certs = $page.userResource.find("certificates") )
				#foreach($ms in $moduleStatuses)
				<tr>
					<td>$ms.website.name</td>
					<td>$ms.programCode / $ms.courseCode / $ms.moduleCode</td>
					<td>
						#if( $ms.complete )
							Complete
						#else
							$!{ms.percentComplete}%
						#end
						#if( $ms.process.stateName )
							( $ms.process.stateName )
						#end
					</td>
					<td>$!ms.createdDate</td>
					<td>$!ms.modifiedDate</td>
					<td>$!ms.quizAttempts.size()</td>
					<td>
						#foreach($file in $certs.files)
						#if( $file.name.startsWith($ms.moduleCode)  )
						<div class="delete-download-container">
							<a class="btn btn-sx btn-default" href="$file.href" target="_blank" title="Download '$file.name'"><i class="fa fa-cloud-download"></i></a>
							<a class="btn btn-sx btn-default btn-delete-download" href="$file.href"><i class="clip-close-2"></i></a>
						</div>
						#end
						#end
					</td>
				</tr>
				#end
				#end
			</tbody>
		</table>
		<hr />
		<h4>Rewards</h4>
		<table class="table table-bordered table-striped table-hover">
			<thead>
				<tr>
					<th>Reward</th>
					<th>For</th>
					<th>Date</th>
				</tr>
			</thead>
			<tbody>
				#if( $rewardEntries.isEmpty() )
				<tr>
					<td colspan="6">No rewards have been given to this user</td>
				</tr>
				#else
				#foreach($re in $rewardEntries)
				<tr>
					<td>$re.reward.name</td>
					<td>$re.reason</td>
					<td>$re.awardedDate</td>
				</tr>
				#end
				#end
			</tbody>
		</table>

	</div>
</div>

<div id="modal-complete-module" aria-hidden="true" tabindex="-1" class="modal modal-xs fade">
	<div class="modal-header">
		<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
		<h4 class="modal-title">Set Module as Complete</h4>
	</div>
	<div class="modal-body">
        <form method="POST" action="." class="form-horizontal">
	        <div class="form-group">
		        <div class="col-md-12">
			        <select class="form-control cbb-program">
				        <option>[Please select a program]</option>
				        #foreach($website in $page.find("/websites").children.ofType.website)
					        #foreach($prog in $website.live.find("programs").availPrograms($user) )
					            <option value="$prog.href">$website.name : $prog.title</option>
					        #end
				        #end
			        </select>
		        </div>
	        </div>
	        <div class="modules-wrapper hide">
		        <p>Please select a program</p>
		        <ul class="row modules-list">
		        </ul>
	        </div>
            <input type="hidden" name="userName" value="$page.profile.name" />
        </form>
    </div>
	<div class="modal-footer">
		<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
		<button type="button" data-type="form-submit" class="btn btn-primary">Save</button>
	</div>
</div> 
<script src="/templates/apps/learner/profileAdminPortlet.js">//</script>
<script type="text/javascript">
	Bob.onDOMReady(function () {
		initAdminProfile();
	});
</script>
