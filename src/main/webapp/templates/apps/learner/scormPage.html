<html>
    <head>
        <title>Module page</title>
        <link rel="stylesheet" href="/theme/apps/learner/modulePage.less" type="text/css" media="all" />
        <link rel="stylesheet" media="print" href="/templates/apps/learner/modulePagePrint.css" type="text/css"/>
        <script src="/theme/apps/learner/scormAPI.js" type="text/javascript" charset="utf-8">//</script>
        <style>
            html,
            body {
                min-height: 100%;
            }

            #module-iframe {
                position: absolute;
                top: 0;
                bottom: 0;
                left: 0;
                right: 0;
                height: 100%;
                width: 100%;
            }

            #iframe-container {
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
            }
        </style>
    </head>
    <body class="modulePage scormpage" style="margin:0px;padding:0px;overflow:hidden">
        <div class='container'>
            <div class="module-container">
                <div class="contentForm">
                    <div class="panelBox">

                        <div class="module-labels">
                            #if( $folder.complete )
                            <div class="alert alert-success">
                                <span class="glyphicon glyphicon-ok"></span>
                                You have completed this module.
                            </div>
                            #elseif ( $folder.percentComplete )

                            #else
                            #if( $folder.completable )
                            #if( $folder.startable )

                            #else
                            <acronym title="You have not completed prequisites">
                                <div class="alert alert-warning">                                
                                    <span class="glyphicon glyphicon-lock"></span>
                                    This module is locked because you have not completed the pre-requisites:
                                    <ul>
                                        #foreach($module in $folder.unmetPrerequisites)
                                        <li>
                                            <a href="$module.href">$module.title</a> 
                                            -
                                            #if( $module.inProgress )                                                                                                        
                                            #if( $module.percentComplete == 100 )
                                            on last page
                                            #else
                                            $module.percentComplete
                                            #end
                                            #else
                                            not started
                                            #end
                                        </li>
                                        #end
                                    </ul>
                                </div>
                            </acronym>
                            #end
                            #else
                            <acronym title="You do not have an enrolement for this module">                            
                                <div class="alert alert-warning">
                                    <span class="glyphicon glyphicon-lock"></span>
                                    This module is view-only. You do not have an enrolement for this module.
                                </div>
                            </acronym>
                            #end
                            #end
                        </div>

                        <div id="iframe-container">
                            #set($scormFile = $folder.find($page.getParam("scormHref")))
                            <iframe id="module-iframe" frameborder="1" src="$page.getParam('scormHref')"></iframe>
                        </div>
                    </div>
                    <script type="text/javascript">
                        progressPage = "$!{formatter.percentEncode($page.parent.currentPage)}";
                    </script>                     
                </div>                           
                #set($viewMode = !$rc.child.editMode && !$request.params.print )
            </div>
        </div>

        #if($viewMode)
        #portlets("userDataModal")

        #portlets("modulePageBottom")
        #end
        
        <script type="text/javascript">
            $(function () {
                $(window).on('resize', function () {
                    flog('ON resize');
                    $('#iframe-container').css('top', $('#maincontentContainer').offset().top);
                }).trigger('resize');
            });
        </script>
    </body>

</html>