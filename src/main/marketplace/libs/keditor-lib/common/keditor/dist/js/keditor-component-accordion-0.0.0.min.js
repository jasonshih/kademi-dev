/**!
 * KEditor - Kademi content editor
 * @copyright: Kademi (http://kademi.co)
 * @author: Kademi (http://kademi.co)
 * @version: 0.0.0
 * @dependencies: $, $.fn.draggable, $.fn.droppable, $.fn.sortable, Bootstrap (optional), FontAwesome (optional)
 */
!function(n){var t=n.keditor,e=t.log;t.components.accordion={settingEnabled:!0,settingTitle:"Accordion Settings",init:function(t,a,o,i){var c=i.options,d=i.generateId("accordion"),l=o.children(".keditor-component-content");l.find(".accordionWrap .panel-group").attr("id",d),l.find(".accordionWrap a[data-toggle]").attr("data-parent","#"+d);var r=l.find(".panel");r.each(function(t,e){var a=n(e),o=i.generateId("heading"+t),c=i.generateId("collapse"+t);if(a.find(".panel-heading").attr("id",o),a.find(".panel-collapse").attr("aria-labelledby",o).attr("id",c),a.find("a[data-toggle]").attr("href","#"+c).attr("aria-controls","#"+c),!a.find("a[data-toggle]").find(".accHeadingText").length){var d=n('<div class="accHeadingText" style="display: inline-block; width: 90%"></div>'),l=n('<div style="display: inline-block; width: 5%; float: right; text-align: right"><i class="fa fa-angle-double-down panelIconCollapsed"></i><i class="fa panelIconExpanded fa-angle-double-up"></i></div>'),r=a.find("a[data-toggle]").text().trim();d.text(r),a.find("a[data-toggle]").html("").append(d).append(l)}}),l.find(".accordionWrap .panel-collapse").collapse("show"),l.find(".panel-footer, .btnAddAccordionItem").removeClass("hide"),l.find(".panel-title a .accHeadingText").prop("contenteditable",!0),l.find(".panel-collapse .panel-body").prop("contenteditable",!0),l.find(".panel-title a .accHeadingText, .panel-collapse .panel-body").on("input",function(n){"function"==typeof c.onComponentChanged&&c.onComponentChanged.call(t,n,o),"function"==typeof c.onContainerChanged&&c.onContainerChanged.call(t,n,a),"function"==typeof c.onContentChanged});var p=l.find(".panel-title a .accHeadingText, .panel-collapse .panel-body").ckeditor(c.ckeditorOptions).editor;p.on("instanceReady",function(){e("CKEditor is ready",o),"function"==typeof c.onComponentReady&&c.onComponentReady.call(t,o,p)}),n(document).off("click",".btnDeleteAccordionItem").on("click",".btnDeleteAccordionItem",function(t){if(t.preventDefault(),confirm("Are you sure you want to delete this item?")){var e=l.find(".panel").length;e>1?n(this).parents(".panel").remove():Msg.error("You cant delete the last item")}}),n(document).off("click",".btnAddAccordionItem").on("click",".btnAddAccordionItem",function(n){n.preventDefault();var a=l.find(".panel").first().clone(),d=i.generateId("heading"),r=i.generateId("collapse");a.find(".panel-heading").attr("id",d),a.find(".panel-collapse").attr("aria-labelledby",d).attr("id",r),a.find("a[data-toggle]").attr("href","#"+r),l.find(".accordionWrap .panel-group").append(a);var p=a.find(".panel-title a .accHeadingText, .panel-collapse .panel-body").ckeditor(c.ckeditorOptions).editor;p.on("instanceReady",function(){e("CKEditor is ready",o),"function"==typeof c.onComponentReady&&c.onComponentReady.call(t,o,p)})})},getContent:function(t,e){var a=t.children(".keditor-component-content");return a.find(".panel-collapse .panel-body").each(function(){var t=n(this).html();n(this).replaceWith('<div class="panel-body">'+t+"</div>")}),"true"==t.attr("data-initial-collapsed")&&a.find(".panel").each(function(){var t=n(this).find(".panel-heading a"),e=n(this).find(".panel-collapse");e.addClass("collapse").attr("aria-expanded","false").removeClass("in"),t.addClass("collapsed").attr("aria-expanded","false")}),a.find(".panel-footer, .btnAddAccordionItem").addClass("hide"),a.find("[contenteditable]").removeAttr("contenteditable"),a.find(".accHeadingText").each(function(){n(this).css("outline","none").text(n(this).text())}),a.html()},destroy:function(n,t){e('destroy "text" component',n);var a=n.find(".keditor-component-content").attr("id"),o=CKEDITOR.instances[a];o&&o.destroy()},initSettingForm:function(t,a){return e('init "accordion" settings',t),n.ajax({url:"/keditor/componentAccordionSettings.html",type:"get",dataType:"HTML",success:function(e){t.html(e),t.find(".collapsedAll").on("click",function(){var n=a.getSettingComponent();n.attr("data-initial-collapsed",this.checked)}),t.find(".panelStyle").on("change",function(n){var t=a.getSettingComponent(),e=t.attr("data-panel-style")||"panel-default";t.attr("data-panel-style",this.value),t.find(".panel").removeClass(e).addClass(this.value)}),n.getStyleOnce("/static/bootstrap-iconpicker/1.7.0/css/bootstrap-iconpicker.min.css"),n.getScriptOnce("/static/bootstrap-iconpicker/1.7.0/js/iconset/iconset-fontawesome-4.2.0.min.js",function(){n.getScriptOnce("/static/bootstrap-iconpicker/1.7.0/js/bootstrap-iconpicker.min.js",function(){t.find(".btn-collapsed-icon, .btn-expanded-icon").iconpicker({iconset:"fontawesome",cols:10,rows:4,placement:"left"}),t.find(".btn-collapsed-icon").on("change",function(n){var t=a.getSettingComponent();t.attr("data-collapsed-icon",n.icon),t.find(".panelIconCollapsed").each(function(){this.className="panelIconCollapsed fa "+n.icon})}),t.find(".btn-expanded-icon").on("change",function(n){var t=a.getSettingComponent();t.attr("data-expanded-icon",n.icon),t.find(".panelIconExpanded").each(function(){this.className="panelIconExpanded fa "+n.icon})})})})}})},showSettingForm:function(t,a,o){e('showSettingForm "Accordion" component');var i=o.getDataAttributes(a,["data-type"],!1);t.find(".collapsedAll").prop("checked","true"==a.attr("data-initial-collapsed")),t.find(".panelStyle").val(a.attr("data-panel-style")),n.getScriptOnce("/static/bootstrap-iconpicker/1.7.0/js/iconset/iconset-fontawesome-4.2.0.min.js",function(){n.getScriptOnce("/static/bootstrap-iconpicker/1.7.0/js/bootstrap-iconpicker.min.js",function(){var n=i["data-collapsed-icon"]||"fa-caret-up";t.find(".btn-collapsed-icon").find("i").attr("class","fa "+n).end().find("input").val(n);var e=i["data-expanded-icon"]||"fa-caret-down";t.find(".btn-expanded-icon").find("i").attr("class","fa "+e).end().find("input").val(e)})})}}}(jQuery);
//# sourceMappingURL=keditor-component-accordion-0.0.0.min.js.map
